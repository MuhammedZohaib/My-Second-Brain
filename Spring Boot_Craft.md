# Spring Boot

First of all we need a spring project for that we have this website which helps us initialize the spring project this website is known as

[https://start.sprint.io](https://start.sprint.io)

Official site for documentation:

[https://www.spring.io](https://www.spring.io)

go to this website and make a project and don't select the snapshot version instead choose stable version.

```other
// Spring annotations

// Rest Controller where our api's are written
@RestController
// API Methods
@GetMapping("/home")
// below annotation marks the class as spring bean, also make the class
  available for dependecy injection
@Components
// allows dependency injection, if we have only one constructor then the below
annotation is optional
@Autowired
```

Core concepts of spring boot:

```other
## Cores of Spring
- Beans
- Core
- SpEL
- Context

## Infrastructure
- AOP
- Aspects
- Instumentaion
- Messaging

## Data Access Layer
- JDBC
- ORM
- Transactions
- OXM
- JMS

## Web Layer
- JSP
- Web Socket
- Web

## Test Layer
- Unit
- Integration
- Mock


# Core
factory for creating beans and managing beans dependencies
# context
holds the beans in the memory
# SpEL
known as spring Expression language used for referring to other beans and in the 
config file and some other functionalities
# AOP
Aspect oriented programming, allows to object declaratively. other than that 
it also allows logging, transactions, security etc
# JMS
known as Java Messaging Service used to send messaeges to a message queue. to
send async messages to a message broker. spring also provides helper classes
for JMS
# Transactions
helper methods for transactions are also provided by Spring. It heavily uses
AOP behind the scenes. can be used for method transactions and as well as 
database transactions.
```

```other
Spring Projects
Basically ad-ons to the spring boot for different types of needs like
- spring cloud
- spring data
- spring batch
- spring security
- spring LDAP
- spring web services

you can explore the projects at 
https://spring.io/projects
```

### Maven

```other
- project management tool for your application
- build management and dependecy managment

how maven works?
reads the config file in the project looks for dependencies on maven local repo
which is on our local computer else it looks on the maven cental repo which is 
remote so first it looks into cache and then it looks online.
```

### Maven Project Structure

```other
src/main/java -> java source code
src/main/resources -> properties and config files used by project
src/main/webapp -> JSP files web config files and web assets
src/test -> unit testing and properties
target -> destination for compiled code
```

### Maven Key Concepts

```other
- POM FILE : known as project object model file, basically our project config
file, always located in the root of the project. it holds mainly three things
  - project metadata
  - dependencies
  - plugins
in plugins we can include plugins such as junit test reports, code coverage etc


- Project Coordinates
project coordinates uniquely identify a project
groupId : name of company, reverse domain etc
artifactId: name of the project
version: release version of the project: 1.0-SNAPSHOT means project is in active
development

where to find dependencies for maven?
https://search.maven.org
```

### Spring Boot Project Structure

```other
intially the project generated by the spring initializer is usually the same as 
the maven project structure but there are some spring wrapper files:
- mvnw
- mvnw.cmd

mvn wrapper allows you to run a maven project without even installing or present 
of maven in path. it also make sure the verison compatibility such that it 
automatically downloads the correct maven version if system has some other
version running. the mvnw.cmd is for windows. mvnw.sh if for linux or mac.


- properties
spring boot will load the properties application.properties file which is located
in src/main/resources. suppose we want to start the server at some other port
instead of 8080 so we will spcify a property in this file as:
server.port = 8585
we can also specify our custom properties in this file to access anywhere in the
project.

to access a property from propeties file use the following:
@Value("$server.port")
private int serverPort; // property injection


by default spring will load static files from src/main/resources/static
these files include html,css,js,image files etc.


IMPORTANT: do not use src/main/webapp if you are using jar as packaging it only
works if the packaging is war.

- Templates: spring boot includes auto configuration for following template
engines:
- FreeMaker
- Thymeleaf
- Mustache
```

### Spring Boot Starters

```other
building a spring app is hard so what dependecies do we need to get started:
for this we use the depdency known as spring-boot-startes it is a collection
of dependecies grouped together which are tested and verified by spring devs.


for spring mvc app:
- spring
- hibernate validator
- thymeleaf

if we add spring boot starters it will automatically add all the above mentioned.
while initializing the spring project via the spring initializer just select the
web in dependencies it will be added.

- spring web
- spring security
- spring data jpa
- thymeleaf

there are in total 30+ spring starters developed by spring development team.
```

### Spring Boot Starter Parent

```other
it is a special starter that provides maven defaults. so basically it is a 
section in the pom.xml file which contains information about the spring boot.
```

### Spring Boot Dev Tools

```other
whenever we make changes in our code we need to restart our server for that we
have a dependency known as spring-boot-devtools it will automatically restart 
the server whenever the changes are saved.
```

### Spring Boot Actuator

```other
basically what spring boot actuator do is expose our endpoint to our windows or 
operating system for free like having a free dev ops functionality for that we
need to add the spring-boot-starter-actuator dependency in pom.xml file.

we can access different actuator endpoint such as below:

/actuator/info
/actuator/health
/actuator/beans

to enable different endpoints of the actuator we use following in 
application.properties file:

// * wildcard to enable all endpoint or we can specify only individual endpoints
management.endpoints.web.exposure.include=*
management.info.env.enabled=true 

// to exculde specific endpoints
management.enpoints.web.exposure.exclude=beans, mappings
```

### Sprint Boot Security

```other
So by default if we use actuator any user can get information about our 
application for that purpose we will add spring-boot-starter-security dependency
in pom.xml file. It'll prompt the user for a password before accessing any 
endpoints. The default username is user and the password is generated by the 
the application in the console we can override these settings by add following in
application.properties file:

spring.security.user.name=Zohaib
spring.security.user.pass=Zohaib123
```

### Running Spring Boot App from Command-line

```other
We can run our springboot application either using a jar file or using the build
system such as maven or gradle

1- java -jar springapp.jar
2- mvnw spring-boot:run

// to make a jar package of application
mvnw package
```

### Injecting Custom Properties in Application

```other
Define any properties in the application.properties file such as:
dev.name=Zohaib

we can access this property anywhere in the app as:

@Value("${dev.name}")
String name;

// The name variable will hold value = Zohaib
```

### Configuring Spring Boot Server

```other
In the application.properties we can set: server port, context path, actuator,
security. Other than that spring boot has 1000+ properties. These properties are
grouped roughly into the following:
- core
- web
- security
- data
- actuator
- integration
- dev tools
- testing

Some of the common properties are as follows:

logging.level.org.springframework=DEBUG
logging.level.org.hibernate=TRACE

// Following are the available options for loggings
- TRACE
- DEBUG
- INFO
- WARN
- ERROR
- FATAL
- OFF

// setting a file for logging instead of console
logging.file=app.log

// some of the web properties
server.port=7070
server.servlet.context-path=/my-silly-app  the default path is /
server.servlet.session.timeout=15m // default time is 30m


// setting some of the actuator properties
management.endpoints.web.base-path=/actuator

// setting data properties
spring.datasource.url=jdbc:mysql://localhost:3306/ecommerce
spring.datasource.username=Zohaib
spring.datasource.password=Zohaib123
```

### Inversion of Control

```other
The approach of outsourcing the construction and management of objects.

suppose we want a cocah it should be like the application should be adaptable to
any type of coach such as cricket, hockey, baseball for this purpose we use 
a factory object and in spring we use spring containers for this purposes.
```

### Spring Containers

```other
Spring containers mainly has two functions:
- create and manage objects (inversion of control)
- inject object dependencies (dependency injection)

How to configure Spring Container?
- XML configuration file (legacy)
- Java Annotations (modern)
- Java Source Code (modern)
```

### Spring Dependency Injection

```other
Dependency Injection make use of dependency inversion principle. The client 
delegates to another object the responsibility of providing its dependencies.

Injection Types in spring:
- constructor injection
- setter injection

which injection type to use?
- constructor injection: use this when you have the required dependencies,
   generally recommended by the spring.io developement team as first choice.

- Setter Injection: use this when you have optional dependencies. if dependency
is not provided your app can provide reasonable default logic

The dependency injection is autowired the spring will look for the matching
class or interface name and automatically inject it.

usually denoted by @Components annotation
```

### Simple Structure

```other
- make an interface
- make a class which implements the interface, also annotate it with @Component
- make a controller class and annotate it with @RestController
- make a constructor and annotate it with @Autowired and initialize the Coach
- make an endpoint using @GetMapping annotation
```

### Component Scanning

```other
@SpringBootApplication this annotation is composed of below annotations:
@EnableAutoConfiguration
@ComponenetScan
@Configuration


@SpringBootApplication(scanBasePackages={
"com.package1",
"com.package2"
})
```

### Setter Injection

```other
Simply give the @Autowired annotation on the method

@AutoWired
public void setCoach(Coach coach){
  this.coach = coach;
}
```

### Field Injection

```other
We can also inject dependencies into the fields such that we do not need setter
or constructor anymore.

@Autowired
private Coach coach;

Field Injection is not recommended because it makes the code difficult to unit
test.
```

### Qualifiers and Primary

```other
Suppose for a given interface we have multiple implementations of it. when the
spring boot will scan for the spring beans it will give error that there was 
supposed to be a single implementation but in reality there were 4 
implementations were found to get over this thing we can use @Qualifier 
annotation to be specific.


private Coach myCoach;

@Autowired
public Controller(@Qualifier("cricketCoach") Coach coach){
  myCoach = coach;
}

in the Qualifier we specify the beanId basically the bean ID, the BeanID is 
actually the className where the first letter is only small.\

Other than the @Qualifier we can also tell the spring boot that we dont care
how many implementations are there i just need one primary implementation which
can be done by specifying the @Primary annotation. if we use the @Primary then we
donot need the @Qualifier annotation.

It is important to not that in multiple implementations we can mark only one 
implementations as Primary if we mark more than one implementation as primary
it will be a problem for our application.

Another important thing to note is that the @Qualifier has higher PRIORITY than
the @Primary.
```

### Lazy Initialization

```other
By default when the application starts all the beans are initialized by the 
spring app. Instead of initializing all the beans upfront we can specify lazy
initialization such that a bean will be only initialized if:
- it is needed for dependecy injection
- if it is explicitly requested

to do this add @Lazy annotation to the class. other than that we can add a prop.
in the application.properties file to specify that all the beans must be lazy 
initialized.

spring.main.lazy-initialization=true

pros and cons of lazy initialization:
- if we have a large number of compnents it may improve the startup time of the
application
- if we have web-related components like @RestController so they wont be created
until requested.
- may nor discover configuration issues until too late.
- also make sure that you have enough memory for all beans once created.

By default it is usually set to off as it might be considered as a premature 
optimization.
```

### Beans Scope

```other
- how long does the bean live?
- how many instances are created?
- how is the bean shared?

the default scope in the spring is singleton: spring only creates one instance
of the bean which is cached in the memory and is used across the lifespan of the
application. we can also explicitly specify the scope of the beans by using
below annotation:

@Scope(ConfigurableBeanFactory.SCOPE_SINGLETON)
we can also specify other scopes also such as below:
- singleton
- prototype (new instance for each container request)
- request (new instance for HTTP web request only used for web applications)
- session (scoped to an web HTTP web session only)
- global-session (scoped to global HTTP session only)
```

### Bean Life-Cycle Methods

```other
we can do some custom logic at bean initialization and bean destruction such
as: 
- @PostConsteruct // after the initialization of the bean
- @PreDestroy // before destroying the bean initialization

give the method names as innit and destroy.
```

?descriptionFromFileType=function+toLocaleUpperCase()+{+[native+code]+}+File&mimeType=application/octet-stream&fileName=Spring+Boot.md&fileType=undefined&fileExtension=md